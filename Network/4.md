# SSL (또는 TLS) 가 어떻게 동작하는지 말씀해주세요.

`어썸오`

TCP는 기본적으로 보안 기능을 제공하지 않습니다. 따라서 안전한 통신을 위해서는 애플리케이션 계층에서 TCP 소켓에 데이터를 쓰기 전에 이를 암호화하는 과정을 거치는데, 이 과정을 거치는 레이어를 Secure Socket Layer, SSL 이라고 부릅니다.

SSL은 TCP 위에서 동작하는 프로토콜이기 때문에 우선 TCP handshake를 통해 TCP 연결을 먼저 맺습니다.

그러고나서 클라이언트는 서버와 SSL 통신을 하기 위해 Client Hello를 합니다. 이때 클라이언트 측에서 생성한 랜덤 데이터, 클라이언트가 지원하는 암호화 방식 등에 대한 데이터를 전달합니다.

서버는 Client Hello에 대한 응답으로 Server Hello를 하게 됩니다. 이때 서버 측에서 생성한 랜덤 데이터, 서버가 선택한 클라이언트의 암호화 방식, 그리고 서버의 인증서를 전달합니다.

클라이언트는 서버로부터 전달받은 인증서를, 클라이언트에 내장된 CA의 공개키를 이용해 복호화합니다. 인증서 내에는 인증 기관에서 인증한 서버의 공개키가 담겨있습니다.

클라이언트는 서버의 랜덤 데이터와 클라이언트의 랜덤 데이터를 조합해 pre master secret을 생성하고 이를 서버의 공개키로 암호화해 서버에 전달합니다.

서버는 개인키로 pre master secret을 복호화하고, 서버와 클라이언트는 일련의 과정을 거쳐 pre master secret을 통해 master secret을 만듭니다. 그리고 이 master secret을 대칭키로 사용하여 서로간의 데이터를 암호화하여 주고받습니다.



https://docs.oracle.com/cd/E19575-01/820-2765/6nebir7f3/index.html
https://opentutorials.org/course/228/4894
https://www.whatswhyhow.com/what-is-difference-between-session-key-and-master-key/
